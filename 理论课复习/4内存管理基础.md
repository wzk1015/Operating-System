# 内存管理基础



## 目录

```
存储器管理目标
存储器硬件发展
存储管理功能
存储器分配方法
覆盖与交换

```

## 索引与重点

存储器硬件P7：易失性

内存性能提升速度低于CPU

存储管理需求P14：独立、保护、多用户

### 存储管理的功能

P16：**存储分配回收、地址变换、存储共享和保护、存储器扩充**

### 固定分区

P22：固定大小分区（相等/不相等）

优点：易实现，开销小

缺点：**内碎片**，限制并发程序数目。

分区表记录分区大小、使用情况

单一队列P23：多个程序排在同一队列等待分区

多队列P24：每个分区一个队列，程序按所需内存大小进入相应队列

### 可变分区

P26：分区大小可变

优点：无内碎片

缺点：**外碎片**

位图表和链表记录分区大小、使用情况

位图P31：每个**单元**一位，0闲置1占用。空间开销固定，时间开销低。没有容错能力。

链表P32：每个节点记录若干个连续内存单元，是否占用、起始地址、大小（单元数目）。空间开销可变，时间开销大，有容错能力。

分配内存：剩余空闲分区<=size时整个分配

回收内存P37

### 分区分配算法

**first fit**：按地址排序，从始端开始查找，选择第一个满足要求的空闲区。低地址留下碎片，增加查找开销

**next fit**：按链表，从上次查找结束处开始，选择第一个满足要求的空闲区。内存利用均衡，但缺乏大空闲分区

**best fit**：选择大小最接近的空闲区。留下碎片。

**worst fit**：选择最大的空闲区。大作业难以满足

### 基于索引搜索的分配算法

快速适应P48：空闲链表。查找效率高，不产生碎片。分区回收开销大，分配空闲分区存在浪费

伙伴系统P49：分配时将大存储块分裂为两块。寻找＞=申请尺寸的最小2幂次的空闲块2^i^，找不到则寻找2^i+1^并分裂。合并时依次合并直到无法合并。优点：速度快；缺点：碎片严重。

### 紧凑技术

外碎片是内存性能下降主要原因。消除方法：紧凑技术P59

实现支撑：**动态重定位**，修改作业内存地址

多重分区分配P62：各段分别放入内存，用重定位寄存器定位



存储保护存储保护键、界限寄存器P65

### 内存扩充

分区管理问题：大作业在小内存中运行，需要更多空间

**覆盖P69**：早期技术。**程序员指定**功能独立程序段，不要求同时装入内存的段共享同一区域。解决大作业、小内存矛盾。对用户不透明，增加用户负担

**交换P71**：把暂时不用的程序数据换到辅存。增加并发程序数目，用户透明。增加CPU开销，未考虑地址访问统计特性。

交换的问题P73：选择换出原则、交换时机、交换工作、换回位置

覆盖、交换的区别P74：减少内存/让出内存，透明/不透明；同一作业/不同作业。



## 小测题

高速缓存基本存储器件：DDR

静态重定位：程序链接

动态重定位：内存紧缩
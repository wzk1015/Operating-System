# 虚拟内存管理



## 目录

```
局部性原理
请求式分页
页面置换
关键设计问题
```



## 索引与重点

常规存储P3：一次性装入，驻留内存。可能出现作业很大、大量作业运行的情况。解决方法：增加内存，覆盖交换（逻辑上扩充内存）。

局部性原理P6

虚拟内存、虚拟存储能力P7：一致地址空间、保护进程地址空间、主存作为磁盘缓存

### 基本原理

请求调入、置换功能P9

**特征：离散性、多次性、对换性、虚拟性**

### 优缺点

P12：增大内存、允许更多并发。牺牲时间

与cache不同P14：时间/空间，数据通路、透明性、未命中损失

### 实存与虚存管理

实存：分区、分页、分段、段页式

虚存：请求分页、请求分段、请求段页式

请求分页/请求分段系统P17

虚存机制要解决的问题P19

### 请求分页式管理

进程的逻辑空间/虚拟地址空间P21

虚拟存储空间P23

交换分区P24

地址映射问题P25

页表项P28



### 调入问题

(part2)P3

按需调页P4、预调页P5

### 缺页中断

P7：陷入内核态、现场保护=>页面定位=>权限检查=>通过页面置换找到空页框=>旧页面写回=>写入新页框=>更新页表=>恢复现场，继续执行

### 页面置换

**OPT**：未来最长时间不访问，无法实现

**FIFO**：驻留时间最长，性能差，belady现象（页框多，缺页率提高）

**改进Second Chance**P19：若之前被访问过则再给一次机会

**改进Clock**P20：环形队列，寻找访问位为0的页面

FIFO类对比P21

**LRU**：过去最久未用。性能好，但开销大。实现方法：链表/计数器

**AGING**P23：接近LRU，开销小

### 工作集

工作集算法P25

更新问题P29，工作集与驻留集P30

页面分配策略P32：固定、可变

页面置换策略P35：局部、全局

分配模式与置换模式的搭配P36’

内存初始分配方法P37

### 抖动问题

P38：**驻留集不断减少，刚换出的页很快就要访问，页面替换频繁**

抖动的消除预防P39：**局部置换、工作计算法、预留页面、挂起若干进程**

负载控制P40：并发度与缺页率权衡

### 关键设计问题

页面清除策略P43：页面缓冲算法

改善时间途径P45：缺页率、外存访问速度、cache命中率

请求分页性能P45

**写时复制技术**P47

**内存映射文件**P49

**存储保护**P51：界限、用户态内核态、存取控制、环保护

## 小测题

程序装载时只对可执行文件进行内存映射，代码和数据只在执行时读入内存

局部性换页策略有利于消除抖动